Restart Node.Js manually:
mongod --dbpath ~/mongodb-data


import React, {

createContext,

useState,

useEffect,

useContext,

useRef,

} from "react";

import axios from "axios";

import { AuthContext } from "./AuthContext.jsx";

import { VendorAuthContext } from "./VendorAuthContext.jsx";


export const CartContext = createContext();


export function CartProvider({ children }) {

const [cart, setCart] = useState([]);


const { isLoggedIn } = useContext(AuthContext);

const { isVendorLoggedIn } = useContext(VendorAuthContext);


const ownerType = isVendorLoggedIn ? "vendor" : isLoggedIn ? "user" : null;


const jwtToken = isVendorLoggedIn

? localStorage.getItem("vendorToken")

: isLoggedIn

? localStorage.getItem("authToken")

: null;


const firstLoad = useRef(true);


const mapBackendCart = (backendCart) =>

backendCart.map((item) => ({

_id: item.product._id,

title: item.product.title,

price: item.product.price,

image: item.product.image,

quantity: item.quantity,

}));


// LOAD CART

useEffect(() => {

async function loadCart() {

try {

if (jwtToken) {

const safe = encodeURIComponent(jwtToken);

const res = await axios.get(

http://localhost:5000/api/cart/get/${safe},

{

withCredentials: true,

}

);

if (res.data.success && res.data.cart) {

setCart(mapBackendCart(res.data.cart));

firstLoad.current = true;

return;

}

}


    const resSession = await axios.get(  
      "http://localhost:5000/api/cart/session",  
      {  
        withCredentials: true,  
      }  
    );  
    if (resSession.data.success && resSession.data.cart) {  
      setCart(mapBackendCart(resSession.data.cart));  
      firstLoad.current = true;  
    }  
  } catch (err) {  
    console.error("LOAD CART ERR:", err);  
  }  
}  

loadCart();  

}, [isLoggedIn, isVendorLoggedIn, jwtToken]);


// SAVE CART

useEffect(() => {

if (!ownerType) return;

if (firstLoad.current) {

firstLoad.current = false;

return;

}


async function save() {  
  try {  
    if (jwtToken) {  
      await axios.post(  
        "http://localhost:5000/api/cart/save",  
        { ownerType, ownerToken: jwtToken, cart },  
        { withCredentials: true }  
      );  
    } else {  
      await axios.post(  
        "http://localhost:5000/api/cart/save-session",  
        { cart },  
        { withCredentials: true }  
      );  
    }  
  } catch (err) {  
    console.error("SAVE CART ERR:", err);  
  }  
}  

save();  

}, [cart, ownerType, jwtToken]);


// CART ACTIONS

const addToCart = (product) => {

const exists = cart.find((i) => i._id === product._id);

if (exists) {

setCart(

cart.map((i) =>

i._id === product._id ? { ...i, quantity: i.quantity + 1 } : i

)

);

} else {

setCart([...cart, { ...product, quantity: 1 }]);

}

};


const removeFromCart = (id) => {

setCart(cart.filter((i) => i._id !== id));

};


const updateQuantity = (id, qty) => {

setCart(

cart.map((i) => (i._id === id ? { ...i, quantity: Math.max(1, qty) } : i))

);

};


// NEW: calculate cart count

const cartCount = cart.reduce((acc, item) => acc + item.quantity, 0);


return (


  {children}  
  

);

}


import { createContext, useState, useEffect } from "react";


export const WishlistContext = createContext();


export function WishlistProvider({ children }) {

const [wishlist, setWishlist] = useState([]);


// Load wishlist from localStorage on start

useEffect(() => {

const saved = JSON.parse(localStorage.getItem("vendorWishlist")) || [];

setWishlist(saved);

}, []);


// Save wishlist to localStorage whenever it changes

useEffect(() => {

localStorage.setItem("vendorWishlist", JSON.stringify(wishlist));

}, [wishlist]);


const toggleWishlist = (product) => {

setWishlist((prev) => {

const exists = prev.find((p) => p._id === product._id);

if (exists) return prev.filter((p) => p._id !== product._id);

return [...prev, product];

});

};


return (


  {children}  
  

);

}


// src/Context/AuthContext.jsx

import React, { createContext, useEffect, useState } from "react";

import axios from "axios";


export const AuthContext = createContext();


export function AuthProvider({ children }) {

const [isLoggedIn, setIsLoggedIn] = useState(false);

const [loading, setLoading] = useState(true); // helps avoid flicker on initial load

const [redirectAfterLogin, setRedirectAfterLogin] = useState(null); // <-- added


useEffect(() => {

const token = localStorage.getItem("authToken");

setIsLoggedIn(Boolean(token));

setLoading(false);

}, []);


async function login(email, password) {

try {

const res = await axios.post(

"http://localhost:5000/api/users/login",

{ email, password },

{ withCredentials: true }

);


  const token = res.data.token;  
  if (token) localStorage.setItem("authToken", token);  

  setIsLoggedIn(true);  
  return { success: true, data: res.data };  
} catch (err) {  
  return {  
    success: false,  
    message: err.response?.data?.message || err.message,  
  };  
}  

}


async function logout() {

try {

await axios.post(

"http://localhost:5000/api/logout",

{},

{ withCredentials: true }

);

} catch (err) {

console.warn("Logout error:", err?.response?.data || err.message);

}


localStorage.removeItem("authToken");  
setIsLoggedIn(false);  

}


return (


  {children}  
  

);

}


import { FiHeart, FiShoppingCart } from "react-icons/fi";

import { useEffect, useState, useContext } from "react";

import { fetchAllProducts } from "../Data/Products";

import { useNavigate } from "react-router-dom";

import Navbar from "../Components/Navbar.jsx";

import { CartContext } from "../Pages/Context/CartContext.jsx";

import HeroSlider from "../Components/HeroSlider.jsx";


export default function ProductsList() {

const [products, setProducts] = useState([]);

const [wishlist, setWishlist] = useState([]);

const navigate = useNavigate();

const { addToCart } = useContext(CartContext); // <-- Keep inside component


// Load products

useEffect(() => {

async function getProducts() {

const data = await fetchAllProducts();

setProducts(data);

}

getProducts();


// Load wishlist from localStorage  
const savedWishlist =  
  JSON.parse(localStorage.getItem("vendorWishlist")) || [];  
setWishlist(savedWishlist);  

}, []);


const goToProduct = (id) => {

navigate(/product/${id});

};


const toggleWishlist = (e, product) => {

e.stopPropagation();

let updatedWishlist = [...wishlist];


if (wishlist.find((p) => p._id === product._id)) {  
  updatedWishlist = wishlist.filter((p) => p._id !== product._id);  
} else {  
  updatedWishlist.push(product);  
}  

setWishlist(updatedWishlist);  
localStorage.setItem("vendorWishlist", JSON.stringify(updatedWishlist));  

};


return (

<>


    {products.map((product) => (  

goToProduct(product._id)}

>


          {/* Wishlist Icon */}  
           toggleWishlist(e, product)}  
          >  
             p._id === product._id)  
                  ? "text-red-500"  
                  : "text-gray-600"  
              }`}  
            />  
            

{product.title}
{product.category}
N{product.price}


          {/* Add to Cart button with alert */}  
           {  
              e.stopPropagation(); // prevent navigating to product detail  
              addToCart(product);  
              alert(`${product.title} successfully added to cart!`);  
            }}  
            className="mt-2 bg-black text-white px-6 py-2 rounded-lg flex items-center justify-center gap-2 mx-auto hover:opacity-80 transition"  
          >  
             Add to Cart  
            
        

    ))}  
  

  

);

}